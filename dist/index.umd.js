(function(l,o){typeof exports=="object"&&typeof module!="undefined"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(l=typeof globalThis!="undefined"?globalThis:l||self,o(l["binary-indexed-tree-js"]={}))})(this,function(l){"use strict";function o(n){return n&1}function g(n,t){return n<t}function d(n,t){return n===t}function c(n){return(t,e)=>!n(e,t)}function s(n,t){return 0<=n&&n<t}function a(n){return n===0?!1:(n&n-1)===0}function _(n){return n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,n|=n>>32,n-(n>>1)}function b(n){return n&-n}function p(n,t){for(;n%2;)n/=2;for(;t%2;)t/=2;return n<t?n:t}class h{constructor(t){this._bit=Array(t).fill(0)}static build(t){const e=new h(t.length);for(let i=0,r=t.length;i<r;++i)e._bit[i]=t[i];for(let i=0,r=t.length-1;i<r;++i){const f=i|i+1;f<=r&&(e._bit[f]+=e._bit[i])}return e}get length(){return this._bit.length}add(t,e){if(!s(t,this.length))return!1;for(let i=t,r=this.length;i<r;i|=i+1)this._bit[i]+=e;return!0}update(t,e){if(!s(t,this.length))return!1;const i=e-this.original(t);return this.add(t,i)}replace(t,e){return this.update(t,e)}original(t){if(!s(t,this.length))return;if(t===0)return this._bit[0];let e=0;const i=p(t,t-1);for(let r=t;r>=i;r=(r&r+1)-1)e+=this._bit[r];for(let r=t-1;r>=i;r=(r&r+1)-1)e-=this._bit[r];return e}get(t){if(!s(t,this.length))return;let e=0;for(let i=t;i>=0;i=(i&i+1)-1)e+=this._bit[i];return e}prefix(t){if(!!s(t,this.length))return t===0?0:this.get(t-1)}sum(){return this.length===0?0:this.get(this.length-1)}find(t){if(typeof t!="function")throw new TypeError;let e=this._bit[0];if(t(e,0,this))return e;for(let i=1,r=this.length;i<r;++i)if(e+=this.original(i),t(e,i,this))return e}findIndex(t){if(typeof t!="function")throw new TypeError;let e=this._bit[0];if(t(e,0,this))return 0;for(let i=1,r=this.length;i<r;++i)if(e+=this.original(i),t(e,i,this))return i;return-1}indexOf(t,e){typeof e!="function"&&(e=d);let i=this._bit[0];if(e(i,t))return 0;for(let r=1,f=this.length;r<f;++r)if(i+=this.original(r),e(i,t))return r;return-1}lastIndexOf(t,e){typeof e!="function"&&(e=d);let i=this.sum();if(e(i,t))return this.length-1;for(let r=this.length-1;0<r;--r)if(i-=this.original(r),e(i,t))return r-1;return-1}lowerBound(t,e){const i=this.length;typeof e!="function"&&(e=g);let r=0,f=_(i)*2;for(;f&&f===(f|0);){const u=b(f);s(f,i+1)&&e(this._bit[f-1],t)?(t-=this._bit[f-1],r=f,f+=u/2):f+=u/2-u}return r}upperBound(t,e){return typeof e!="function"&&(e=g),this.lowerBound(t,c(e))}toArray(){const t=Array(this.length).fill(0);for(let e=0,i=this.length;e<i;++e)t[e]=this._bit[e];for(let e=2,i=this.length;e<i;++e)o(e)?a(e+1)||(t[e]+=t[(e&e+1)-1]):t[e]+=t[e-1];return t}}l.default=h,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
